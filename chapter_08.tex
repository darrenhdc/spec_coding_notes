% chapter_08.tex
% Lines 63853 to 72988 of original content

{\small

\section*{Chapter 8: LSP, Spec Coding, and System Design}

\subsection*{OpenCode vs Claude Code: Why LSP is Explicit vs Implicit}

\subsubsection*{Core Question: Why does OpenCode highlight LSP as a feature?}

OpenCode æŠŠã€Œæ˜¾å¼ LSPã€å½“å–ç‚¹ï¼Œä¸æ˜¯å› ä¸ºå®ƒæ¯” Claude Code / Droid æ›´"å…ˆè¿›"ï¼Œè€Œæ˜¯å› ä¸ºå®ƒè§£å†³çš„æ˜¯ã€Œå¼€æºã€å¯æ§ã€å¯éªŒè¯ã€è¿™ä¸ªå±‚çº§çš„é—®é¢˜ã€‚

\textbf{ä¸€å¥è¯å¯¹æ¯”ï¼š}
\begin{itemize}
  \item Claude Code / Droidï¼š"æˆ‘æœ‰ï¼Œä½†ä½ åˆ«ç®¡"
  \item OpenCodeï¼š"æˆ‘æœ‰ï¼Œè€Œä¸”ä½ å¯ä»¥çœ‹ã€å¯ä»¥æ§ã€å¯ä»¥æ¢"
\end{itemize}

\subsubsection*{Why Claude Code / Droid Don't Mention LSP}

å¯¹äºé—­æº/å¼ºç³»ç»Ÿæ¥è¯´ï¼ŒLSP æ˜¯"ç†æ‰€å½“ç„¶çš„å†…è„å™¨å®˜"ï¼š
\begin{itemize}
  \item LSP â‰ˆ AST / symbol graph / semantic index
  \item æ˜¯ agent çš„åŸºç¡€è®¾æ–½
  \item ç”¨æˆ·æ— æƒã€ä¹Ÿæ— å¿…è¦å¹²é¢„
\end{itemize}

å®ƒä»¬çš„å™äº‹æ˜¯"æˆ‘ç†è§£ä½ çš„ä»£ç "ï¼Œè€Œä¸æ˜¯"æˆ‘ç”¨ LSP ç†è§£ä½ çš„ä»£ç "ã€‚æ˜¾å¼æš´éœ² LSP åè€Œä¼š"é™ä½æŠ½è±¡å±‚çº§"â€”â€”å¦‚æœä½ è¿˜éœ€è¦é€‰ LSPã€çœ‹è¯Šæ–­ï¼Œè¯´æ˜ agent æ²¡æŠŠäº‹æƒ…åšå¥½ã€‚

\subsubsection*{Why OpenCode Must Highlight LSP}

\textbf{1. OpenCode æ˜¯ã€Œå¼€æº Agent æ¡†æ¶ã€ï¼Œä¸æ˜¯ã€Œå°è£…å¥½çš„ Agentã€}

ç”¨æˆ·æ˜¯å¼€å‘è€…ã€æ¶æ„å¸ˆã€OSS ç¤¾åŒºã€ä¼ä¸š IT/å®‰å…¨å›¢é˜Ÿã€‚ä»–ä»¬å…³å¿ƒçš„æ˜¯ï¼š
\begin{itemize}
  \item AI åˆ°åº•"çœ‹åˆ°äº†ä»€ä¹ˆ"
  \item æ˜¯å¦çœŸçš„ç†è§£ä»£ç 
  \item èƒ½ä¸èƒ½åœ¨æˆ‘ç¯å¢ƒé‡Œå¤ç°
\end{itemize}

æ˜¾å¼ LSP = å¯éªŒè¯çš„å·¥ç¨‹æ‰¿è¯ºã€‚

\textbf{2. OpenCode å¿…é¡»å¯¹æŠ—ä¸€ä¸ªé»˜è®¤æ€€ç–‘}

åœ¨å¼€æºä¸–ç•Œï¼š"ä½ è¯´ä½ ç†è§£ä»£ç ï¼Ÿä½ æ˜¯ä¸æ˜¯åªæ˜¯ grep + promptï¼Ÿ"

OpenCode ç”¨ "LSP enabled" æ˜ç¡®å‘Šè¯‰ä½ ï¼š
\begin{itemize}
  \item æˆ‘ä¸æ˜¯çº¯æ–‡æœ¬ agent
  \item æˆ‘èµ°çš„æ˜¯æ ‡å‡†è¯­è¨€åè®®
  \item æˆ‘èƒ½è·‘åœ¨ä½ çš„æœ¬åœ°ç¯å¢ƒ
\end{itemize}

è¿™æ˜¯ä¿¡ä»»æ„å»ºï¼Œè€Œä¸æ˜¯ç‚«æŠ€ã€‚

\textbf{3. OpenCode éœ€è¦å’Œã€ŒèŠå¤©å¼ AIã€æ˜ç¡®åˆ‡å‰²}

æœ€å¤§çš„ç«äº‰å¯¹æ‰‹ä¸æ˜¯ Claude Code / Droidï¼Œè€Œæ˜¯"CLI èŠå¤©æœºå™¨äºº"ã€"åŒ…äº†ä¸€å±‚ UI çš„ ChatGPT"ã€‚LSP æ˜¯æœ€å¥½ã€æœ€ç›´è§‚çš„å·¥ç¨‹ä¿¡å·ï¼š"æˆ‘æ˜¯å·¥ç¨‹ agentï¼Œä¸æ˜¯ chat bot"ã€‚

\textbf{4. OpenCode çš„"å¯æ›¿æ¢æ€§ç„¦è™‘"}

OpenCode çš„å®šä½æ˜¯ Model-agnostic Agent Runtimeï¼Œæ„å‘³ç€æ¨¡å‹éšæ—¶å¯èƒ½æ¢ï¼Œèƒ½åŠ›ä¸èƒ½ä¾èµ–æ¨¡å‹"èªæ˜"ã€‚é‚£ä»€ä¹ˆæ˜¯\textbf{ä¸éšæ¨¡å‹å˜åŒ–çš„ç¡®å®šæ€§èƒ½åŠ›}ï¼Ÿ

LSPï¼šæœ¬åœ°ã€ç¡®å®šã€å¯æµ‹è¯•ã€å’Œæ¨¡å‹èƒ½åŠ›è§£è€¦ã€‚

\subsubsection*{Spec-Coding è§†è§’ä¸‹çš„ç†è§£}

ä½ ä¹‹å‰é—®è¿‡çš„ memoryã€spec è¿ç»­æ€§ã€è´¦å·åˆ‡æ¢ï¼Œéƒ½æ˜¯åœ¨é—®ï¼š"ä»€ä¹ˆä¸œè¥¿æ˜¯ä¸éšæ¨¡å‹ã€ä¸éš context æ¼‚ç§»çš„ï¼Ÿ"

ç­”æ¡ˆå…¶å®æ˜¯åŒä¸€ç±»ï¼šspecï¼ˆæ–‡æ¡£ï¼‰ã€LSPï¼ˆç»“æ„åŒ–ä»£ç ç†è§£ï¼‰ã€repoï¼ˆå·¥ç¨‹äº‹å®ï¼‰ã€‚OpenCode åœ¨ marketing ä¸ŠæŠŠè¿™äº›éƒ½"æ˜¾å¼åŒ–"äº†ã€‚

\subsubsection*{Ultimate Analogy}
\begin{itemize}
  \item Claude Code / Droid â†’ iPhoneï¼šå¼ºã€å°é—­ã€ä¸è®©ä½ çœ‹åŸºå¸¦
  \item OpenCode â†’ Linuxï¼šä½ èƒ½çœ‹åˆ°å†…æ ¸ã€èƒ½é€‰é©±åŠ¨ã€èƒ½è‡ªå·±ç¼–
\end{itemize}

\textbf{ä¸€å¥è¯æ€»ç»“ï¼š}LSP åœ¨ Claude Code / Droid ä¸­æ˜¯"é»˜è®¤å‰æ"ï¼Œåœ¨ OpenCode ä¸­æ˜¯"å…¬å¼€æ‰¿è¯º"ï¼›å‰è€…è¿½æ±‚æŠ½è±¡å®Œæˆåº¦ï¼Œåè€…è¿½æ±‚å¯æ§ä¸å¯éªŒè¯ã€‚

% =================================================================

\subsection*{LSP-First Workflow: How to Use LSP Effectively}

åœ¨å¤§å¤šæ•° AI coding agent é‡Œï¼Œä½ "ä¸ä¼šç›´æ¥ä½¿ç”¨ LSP"ï¼Œè€Œæ˜¯é€šè¿‡"æ­£ç¡®çš„å·¥ä½œæ–¹å¼"è®© agent å»ç”¨ LSPã€‚

\subsubsection*{Core Principle}

LSP ä¸æ˜¯ä¸€ä¸ªä½ å»ç‚¹çš„åŠŸèƒ½ï¼Œè€Œæ˜¯ä¸€å¥—ä½ è¦"é€¼ç€ agent ä¾èµ–"çš„äº‹å®æ¥æºã€‚ä½ è¦åšçš„ä¸æ˜¯"æ“ä½œ LSP"ï¼Œè€Œæ˜¯ï¼š
\begin{itemize}
  \item \textbf{è®© agent å¿…é¡»é€šè¿‡ LSP æ‰èƒ½å›ç­”}
  \item \textbf{ä¸å…è®¸å®ƒé çŒœ}
\end{itemize}

\subsubsection*{Four LSP-First Behaviors}

\textbf{1. è¦æ±‚åŸºäºç¬¦å·è€Œä¸æ˜¯æ–‡æœ¬è¡ŒåŠ¨}

é”™è¯¯ç¤ºä¾‹ï¼ˆä¸è§¦å‘ LSPï¼‰ï¼š"æŠŠè¿™ä¸ªå‡½æ•°æ”¹ä¸€ä¸‹ï¼Œè®©å®ƒæ›´æ¸…æ™°"

æ­£ç¡®ç¤ºä¾‹ï¼ˆå¼ºçƒˆè§¦å‘ LSPï¼‰ï¼š"é‡æ„ UserService.createUserï¼Œè¦æ±‚ï¼šä¸æ”¹å˜ public signatureã€æ›´æ–°æ‰€æœ‰è°ƒç”¨ç‚¹ã€å¦‚æœæœ‰ç±»å‹å†²çªï¼ŒæŒ‡å‡ºå…·ä½“æ–‡ä»¶å’Œè¡Œå·"

ğŸ‘‰ è¿™ç±»è¦æ±‚æ²¡æœ‰ LSP å‡ ä¹åšä¸åˆ°ã€‚

\textbf{2. è¦æ±‚ agent å®šä½å®šä¹‰ / å¼•ç”¨}

"åœ¨å½“å‰ repo ä¸­ï¼šæ‰¾åˆ° PaymentProcessor çš„å®šä¹‰ã€åˆ—å‡ºæ‰€æœ‰ç›´æ¥è°ƒç”¨å®ƒçš„åœ°æ–¹ã€åˆ¤æ–­æ˜¯å¦å­˜åœ¨å¾ªç¯ä¾èµ–"

ğŸ‘‰ è¿™æ˜¯æ ‡å‡† LSP queryï¼ˆgo to definition / find referencesï¼‰ã€‚

\textbf{3. è¦æ±‚ç±»å‹çº§åˆ«çš„ä¿è¯}

"ç¡®è®¤è¿™ä¸ªæ”¹åŠ¨ï¼šä¸å¼•å…¥æ–°çš„ TypeScript ç±»å‹é”™è¯¯ã€ä¸ç ´å Rust çš„ borrow è§„åˆ™ã€ä¸æ”¹å˜ Python public API çš„ typing"

ğŸ‘‰ æ²¡æœ‰ LSPï¼Œè¿™åªèƒ½é "æ„Ÿè§‰"ï¼›æœ‰ LSPï¼Œè¿™æ˜¯ç¡®å®šæ€§æ£€æŸ¥ã€‚

\textbf{4. è®© agent å…ˆåˆ†æå†æ”¹ä»£ç }

"åœ¨ä¿®æ”¹ä»»ä½•ä»£ç å‰ï¼šç”¨è¯­è¨€æœåŠ¡å™¨åˆ†æç›¸å…³æ¨¡å—ã€æ€»ç»“å½“å‰ç»“æ„å’Œä¾èµ–ã€å†ç»™å‡ºä¿®æ”¹æ–¹æ¡ˆ"

è¿™ä¸€æ­¥ä¼šæŠŠ agent å¼ºåˆ¶æ‹‰åˆ° LSP â†’ plan â†’ edit çš„è·¯å¾„ã€‚

\subsubsection*{Tool-Specific Usage}

\textbf{OpenCodeï¼š} ä½ æœ€èƒ½"çœ‹è§" LSP çš„åœ°æ–¹
\begin{itemize}
  \item è‡ªåŠ¨æ£€æµ‹è¯­è¨€ã€å¯åŠ¨å¯¹åº” LSPã€æŠŠ LSP æŸ¥è¯¢ç»“æœå–‚ç»™ agent
  \item ç”¨"å·¥ç¨‹å‹æŒ‡ä»¤"é©±åŠ¨ agent
  \item å½“ agent çŠ¯é”™æ—¶ï¼Œä½ å¯ä»¥è¯´ï¼š"ä¸è¦çŒœï¼Œå¦‚æœä¸ç¡®å®šï¼Œè¯·ç”¨è¯­è¨€æœåŠ¡å™¨ç¡®è®¤"â€”â€”è¿™å¥è¯çœŸçš„æœ‰çº¦æŸåŠ›
\end{itemize}

\textbf{Claude Codeï¼š} LSP æ˜¯"éšå¼çš„"ï¼Œä½†ä½ ä»ç„¶èƒ½ç”¨
\begin{itemize}
  \item âŒ ä½ çœ‹ä¸åˆ°ã€âŒ ä½ ä¸èƒ½é…ç½®ã€âœ… ä½ å¯ä»¥é€šè¿‡ä»»åŠ¡å½¢å¼é€¼å®ƒç”¨
  \item æ°¸è¿œé¿å…"æ¨¡ç³Šæ”¹æ³•"ï¼Œè¦è¯´"é€šè¿‡åˆ†æç±»å‹å’Œå¼•ç”¨å…³ç³»ï¼Œé‡æ„ Xï¼Œä¸å…è®¸ç ´åç°æœ‰è°ƒç”¨"
  \item è¦æ±‚"å¤±è´¥å°±è¯´ä¸çŸ¥é“"ï¼š"å¦‚æœæ— æ³•é€šè¿‡é™æ€åˆ†æç¡®è®¤ï¼Œè¯·æ˜ç¡®è¯´æ˜ä¸ç¡®å®šæ€§"
\end{itemize}

\textbf{Droidï¼š} ä½ ç”šè‡³ä¸ç”¨å…³å¿ƒ LSP
\begin{itemize}
  \item LSP = ç³»ç»Ÿåº•å±‚äº‹å®æº
  \item ä½ åªéœ€è¦è¯´ï¼š"æ ¹æ®å½“å‰ specï¼Œä¿®æ”¹å®ç°ï¼Œä¸å…è®¸å¼•å…¥æœªå£°æ˜è¡Œä¸º"
  \item Droid ä¼šè‡ªåŠ¨èµ° LSP â†’ spec â†’ code
\end{itemize}

\subsubsection*{Counter-Intuitive Truth}

ä½ è¶Š"æ‰‹åŠ¨æ“ä½œ LSP"ï¼Œè¶Šè¯´æ˜ agent è®¾è®¡å¾—ä¸å¤Ÿå¥½ã€‚çœŸæ­£æˆç†Ÿçš„ agent å·¥ä½œæµæ˜¯ï¼š
\begin{verbatim}
ä½ çš„æŒ‡ä»¤
  â†“
spec / intent
  â†“
LSP / AST / graphï¼ˆè‡ªåŠ¨ï¼‰
  â†“
ä¿®æ”¹æ–¹æ¡ˆ
  â†“
æœ€å°å®‰å…¨æ”¹åŠ¨
\end{verbatim}

\subsubsection*{Five Rules to Maximize LSP Value}
\begin{enumerate}
  \item æ°¸è¿œç”¨ç¬¦å·åï¼Œä¸ç”¨"è¿™ä¸ªå‡½æ•°"
  \item è¦æ±‚æ›´æ–°æ‰€æœ‰å¼•ç”¨
  \item è¦æ±‚ç±»å‹ä¸å˜ / API ä¸å˜
  \item å…ˆåˆ†æï¼Œå†å®ç°
  \item å…è®¸ agent è¯´"ä¸ç¡®å®šï¼Œéœ€è¦ç¡®è®¤"
\end{enumerate}

\textbf{ä¸€å¥è¯æ€»ç»“ï¼š}ä½¿ç”¨ LSP çš„å…³é”®ä¸åœ¨äº"æ“ä½œå®ƒ"ï¼Œè€Œåœ¨äº"æå‡ºåªæœ‰ LSP æ‰èƒ½å®Œæˆçš„ä»»åŠ¡"ã€‚

% =================================================================

\subsection*{PRD.md, plan.md, CLAUDE.md: Three-Layer Control System}

\subsubsection*{One-Sentence Overview}

\begin{itemize}
  \item PRD.md = ä¸ºä»€ä¹ˆè¦åšï¼ˆWhat \& Whyï¼‰
  \item plan.md = æ‰“ç®—æ€ä¹ˆåšï¼ˆHow, at è®¾è®¡å±‚ï¼‰
  \item CLAUDE.md = Claude åœ¨è¿™ä¸ª repo é‡Œ"è¯¥å¦‚ä½•å½“ä¸€ä¸ªå·¥ç¨‹å¸ˆ"
\end{itemize}

ä¸‰è€…ä¸æ˜¯åŒä¸€å±‚çº§çš„æ–‡æ¡£ï¼Œè€Œæ˜¯ä¸‰å±‚æ§åˆ¶é¢ã€‚

\subsubsection*{PRD.md â€” äº§å“äº‹å®å±‚ï¼ˆIntent / Truthï¼‰}

PRD æ˜¯"éœ€æ±‚çš„çœŸç†æ¥æº"ï¼Œä¸æ˜¯ç»™ Claude å‘æŒ¥çš„ï¼Œè€Œæ˜¯ç”¨æ¥çº¦æŸ Claude çš„ã€‚

\textbf{è§£å†³çš„é—®é¢˜ï¼š}
\begin{itemize}
  \item è¦åšä»€ä¹ˆåŠŸèƒ½
  \item ç”¨æˆ·æ˜¯è°
  \item è¡Œä¸ºè¾¹ç•Œåœ¨å“ªé‡Œ
  \item \textbf{ä¸åšä»€ä¹ˆï¼ˆéå¸¸é‡è¦ï¼‰}
\end{itemize}

\textbf{ç‰¹æ€§ï¼š}ç¨³å®šï¼ˆä¸é¢‘ç¹æ”¹ï¼‰ã€éæŠ€æœ¯ä¸ºä¸»ã€äºº \& AI éƒ½è¦éµå®ˆ

\textbf{å…¸å‹å†…å®¹ï¼š}
\begin{verbatim}
# Product Requirements

## Goals
- ç”¨æˆ·å¯ä»¥åˆ›å»º / ç¼–è¾‘ / åˆ é™¤ä»»åŠ¡

## Non-Goals
- ä¸æ”¯æŒå¤šç§Ÿæˆ·
- ä¸æ”¯æŒæƒé™ç³»ç»Ÿ

## User Stories
- As a user, I can ...
\end{verbatim}

\textbf{ä¸è¯¥æœ‰çš„ä¸œè¥¿ï¼š}æŠ€æœ¯é€‰å‹ã€æ–‡ä»¶ç»“æ„ã€ç±»å/å‡½æ•°å

\subsubsection*{plan.md â€” æŠ€æœ¯å†³ç­–å±‚ï¼ˆDesign / Architectureï¼‰}

plan.md æ˜¯"åœ¨ä¸è¿å PRD çš„å‰æä¸‹ï¼Œæˆ‘ä»¬å†³å®šå¦‚ä½•å®ç°"ã€‚è¿™æ˜¯å·¥ç¨‹è®¾è®¡æ–‡æ¡£ã€‚

\textbf{è§£å†³çš„é—®é¢˜ï¼š}
\begin{itemize}
  \item ç”¨ä»€ä¹ˆæŠ€æœ¯æ ˆ
  \item æ¨¡å—æ€ä¹ˆæ‹†
  \item æ•°æ®æµ / æ§åˆ¶æµ
  \item å…³é”® trade-off
\end{itemize}

\textbf{ç‰¹æ€§ï¼š}æ¯” PRD æ›´æ˜“å˜ã€å¼ºæŠ€æœ¯å¯¼å‘ã€ç»™ Claude ä¸€ä¸ª"ä¸è¦ä¹±è®¾è®¡"çš„è¾¹ç•Œ

\textbf{å…¸å‹å†…å®¹ï¼š}
\begin{verbatim}
# Implementation Plan

## Architecture
- Frontend: React
- Backend: FastAPI

## Key Decisions
- ä½¿ç”¨ REST è€Œä¸æ˜¯ GraphQLï¼ˆåŸå› ï¼šç®€å•ï¼‰

## Constraints
- ä¸å¼•å…¥ ORM
- ä¿æŒ API å‘åå…¼å®¹
\end{verbatim}

\textbf{ä¸è¯¥æœ‰çš„ä¸œè¥¿ï¼š}å…·ä½“ä»£ç å®ç°ã€é€è¡Œé€»è¾‘ã€prompt æŒ‡ä»¤

\subsubsection*{CLAUDE.md â€” Agent è¡Œä¸ºæ§åˆ¶å±‚ï¼ˆMeta / Governanceï¼‰}

è¿™æ˜¯ Claude Code ç‰¹æœ‰ã€ä¹Ÿæ˜¯æœ€å®¹æ˜“è¢«ä½ä¼°çš„æ–‡ä»¶ã€‚

CLAUDE.md ä¸æ˜¯"é¡¹ç›®æ–‡æ¡£"ï¼Œè€Œæ˜¯"Claude çš„æ“ä½œæ‰‹å†Œ"ã€‚

\textbf{è§£å†³çš„é—®é¢˜ï¼š}
\begin{itemize}
  \item Claude åœ¨è¿™ä¸ª repo é‡Œåº”è¯¥æ€ä¹ˆå·¥ä½œ
  \item ä»€ä¹ˆæ—¶å€™å¯ä»¥æ”¹ä»£ç 
  \item ä»€ä¹ˆæ—¶å€™å¿…é¡»å…ˆé—®
  \item ä½¿ç”¨ä»€ä¹ˆé£æ ¼ / è§„åˆ™
\end{itemize}

è¿™æ˜¯å¯¹ AI çš„"constitution"ã€‚

\textbf{å…¸å‹å†…å®¹ï¼š}
\begin{verbatim}
# Claude Instructions

## General Rules
- ä¸å¾—å¼•å…¥æ–°ä¾èµ–ï¼Œé™¤éæ˜ç¡®è¯´æ˜
- ä¿®æ”¹å‰å¿…é¡»å…ˆåˆ†æå½±å“èŒƒå›´

## Coding Style
- ä½¿ç”¨å‡½æ•°å¼é£æ ¼
- æ‰€æœ‰ public API å¿…é¡»æœ‰æ³¨é‡Š

## Workflow
- ä¿®æ”¹å‰å…ˆæ€»ç»“è®¡åˆ’
- ä¸å…è®¸ç›´æ¥å¤§è§„æ¨¡é‡æ„
\end{verbatim}

\textbf{ä¸é€‚åˆæ”¾çš„å†…å®¹ï¼š}äº§å“éœ€æ±‚ï¼ˆé‚£æ˜¯ PRDï¼‰ã€æŠ€æœ¯æ¶æ„ï¼ˆé‚£æ˜¯ planï¼‰ã€ä¸´æ—¶èŠå¤©æŒ‡ä»¤ï¼ˆé‚£æ˜¯ promptï¼‰

\subsubsection*{Control Direction Comparison}

\begin{tabular}{l|l|l|l}
æ–‡ä»¶ & æ§åˆ¶è° & æ§åˆ¶ä»€ä¹ˆ & ç¨³å®šæ€§ \\ \hline
PRD.md & äºº + AI & äº§å“è¾¹ç•Œ & âœ… é«˜ \\
plan.md & AI ä¸ºä¸» & æŠ€æœ¯å®ç°æ–¹å¼ & âš ï¸ ä¸­ \\
CLAUDE.md & Claude & è¡Œä¸º / å†³ç­–æ–¹å¼ & âœ… é«˜ \\
\end{tabular}

å¯ä»¥ç†è§£ä¸ºï¼šPRD = æ³•å¾‹ï¼Œplan = æ–½å·¥å›¾ï¼ŒCLAUDE.md = æ–½å·¥é˜Ÿæ“ä½œè§„èŒƒã€‚

\subsubsection*{How They Work Together in Claude Code}

ç†æƒ³çš„ Claude Code å¼€å‘æµç¨‹ï¼š
\begin{enumerate}
  \item Claude è¯»å– CLAUDE.md â†’ çŸ¥é“ã€Œæˆ‘è¯¥æ€ä¹ˆå½“ä¸€ä¸ªå·¥ç¨‹å¸ˆã€
  \item Claude å‚è€ƒ PRD.md â†’ çŸ¥é“ã€Œæˆ‘ä¸èƒ½è¶Šç•Œã€
  \item Claude éµå¾ª plan.md â†’ çŸ¥é“ã€Œæˆ‘è¯¥æ€ä¹ˆå®ç°ã€
  \item Claude æ‰ä¼šï¼šåˆ†æã€æå‡ºä¿®æ”¹ã€å®ç°ä»£ç 
\end{enumerate}

\subsubsection*{Common Errors}

\textbf{é”™è¯¯ 1ï¼š}æŠŠæŒ‡ä»¤å†™è¿› PRD â€”â€” "ä½ åº”è¯¥ç”¨ React å®ç°è¿™ä¸ªåŠŸèƒ½" â†’ è¿™æ˜¯ planï¼Œä¸æ˜¯ PRDã€‚

\textbf{é”™è¯¯ 2ï¼š}æŠŠ prompt ä¸´æ—¶è§„åˆ™å¡è¿› plan â€”â€” "ä½ ä¿®æ”¹å‰è¦å…ˆç¡®è®¤ç±»å‹" â†’ è¿™æ˜¯ CLAUDE.mdã€‚

\textbf{é”™è¯¯ 3ï¼š}æ²¡æœ‰ CLAUDE.mdï¼Œå´æŠ±æ€¨ Claude "ä¹±æ¥" â†’ æ²¡æœ‰è¡Œä¸ºçº¦æŸï¼ŒAI å¿…ç„¶å‘æŒ¥ã€‚

\subsubsection*{Spec-kit Mapping}

å¦‚æœç”¨ spec-kitï¼š
\begin{itemize}
  \item spec-kit æ–‡ä»¶ â†’ å¯¹åº”æ¦‚å¿µ
  \item spec.md â†’ PRDï¼ˆåŠŸèƒ½çº§ï¼‰
  \item plan.md â†’ plan
  \item constitution.md â‰ˆ CLAUDE.md
\end{itemize}

\textbf{ä¸€å¥è¯æ€»ç»“ï¼š}PRD.md å†³å®š"èƒ½ä¸èƒ½åš"ï¼Œplan.md å†³å®š"æ€ä¹ˆåš"ï¼ŒCLAUDE.md å†³å®š"Claude åšäº‹åƒä¸åƒä¸€ä¸ªé è°±å·¥ç¨‹å¸ˆ"ã€‚

% =================================================================

\subsection*{Implicit vs Explicit: What Happens Without PRD/plan/CLAUDE.md?}

\subsubsection*{Core Conclusion}

ä¼š"çœ‹èµ·æ¥åƒåœ¨æ‰§è¡Œ"ï¼Œä½†ä¸æ˜¯åœ¨"å¯é åœ°æ‰§è¡Œ"ã€‚

æ¢å¥è¯è¯´ï¼š
\begin{itemize}
  \item âœ… Claude Code åœ¨æ²¡æœ‰ PRD / plan / CLAUDE.md çš„æƒ…å†µä¸‹ï¼Œä¼šéšå¼æ¨¡æ‹Ÿä¸€ä¸ªç±»ä¼¼æµç¨‹
  \item âŒ ä½†è¿™ä¸ªæµç¨‹æ˜¯ï¼šä¸ç¨³å®šçš„ã€ä¸å¯å®¡è®¡çš„ã€ä¸å¯ç»§æ‰¿çš„ã€ä¸å¯å¤ç°çš„
\end{itemize}

\subsubsection*{What Claude Code Actually Does Without Documents}

Claude Code å¹¶ä¸æ˜¯"æ— æµç¨‹"ï¼Œè€Œæ˜¯ï¼šæŠŠ PRD / plan / è¡Œä¸ºè§„èŒƒï¼Œå…¨éƒ½ä¸´æ—¶å¡è¿›äº†å¯¹è¯ä¸Šä¸‹æ–‡é‡Œã€‚

å¯ä»¥ç†è§£ä¸ºï¼š
\begin{verbatim}
prompt + å½“å‰ repo
= å³æ—¶ PRD
= å³æ—¶ plan
= å³æ—¶ CLAUDE.md
\end{verbatim}

è¿™äº›ä¸œè¥¿å­˜åœ¨ï¼Œä½†ï¼šåªå­˜åœ¨äºå½“å‰å¯¹è¯ã€ä¸å¯è§ã€ä¸å¯å¤ç”¨ã€ä¸å¯æ ¡éªŒã€‚

\subsubsection*{Why It Feels Like It Works}

\textbf{1ï¸âƒ£ æ¨¡å‹æœ¬èº«å†…å»ºäº†ã€Œä¼˜ç§€å·¥ç¨‹å¸ˆçš„éšå¼æ¨¡å¼ã€}

Claude éå¸¸æ“…é•¿ï¼šå…ˆè§£é‡Šç†è§£ã€å†æå‡ºæ–¹æ¡ˆã€æœ€åå†™ä»£ç ã€‚è¿™æ˜¯æ¨¡å‹è®­ç»ƒå‡ºæ¥çš„"é»˜è®¤è¡Œä¸º"ã€‚

\textbf{2ï¸âƒ£ Claude Code è‡ªåŠ¨åš repo åˆ†æï¼ˆå« LSP / ASTï¼‰}

å³ä½¿ä½ æ²¡è¯´ï¼Œå®ƒä¹Ÿä¼šï¼šæ‰«æé¡¹ç›®ç»“æ„ã€çŒœæµ‹æ¶æ„ã€æ‰¾å…¥å£ç‚¹ã€‚è¿™è®©å®ƒçœ‹èµ·æ¥åƒæ˜¯æœ‰ planã€‚

\textbf{3ï¸âƒ£ äººç±» prompt æœ¬èº«å¾€å¾€æ˜¯"åŠä¸ª PRD"}

ä½ é€šå¸¸ä¼šè¯´ï¼š"æˆ‘è¦å®ç° Xï¼Œè¦æ±‚ Yï¼Œä¸è¦ Z"ã€‚è¿™å·²ç»æ˜¯ä¸€ä¸ªç®€åŒ–ç‰ˆ PRD äº†ã€‚

\subsubsection*{The Distortion Points}

\textbf{âŒ 1ï¸âƒ£ PRD æ˜¯"éšå¼çš„"ï¼Œæ‰€ä»¥ä¼šæ¼‚ç§»}

ä½ ç¬¬ä¸€è½®è¯´çš„"ä¸åš Z"ï¼Œä¸‹ä¸€è½®å¯¹è¯æ²¡å†æï¼ŒClaude Code å¾ˆå¯èƒ½ï¼šå¿˜äº†ã€æˆ–é‡æ–°å‡è®¾ã€‚è¿™ä¸æ˜¯ bugï¼Œæ˜¯ä¸Šä¸‹æ–‡çš„è‡ªç„¶è¡°å‡ã€‚

\textbf{âŒ 2ï¸âƒ£ plan æ˜¯"å³æ—¶ç”Ÿæˆçš„"ï¼Œä¸æ˜¯é•¿æœŸçº¦æŸ}

Claude Code çš„ planæ˜¯ï¼š"æˆ‘è¿™ä¸€æ¬¡è§‰å¾—æ€ä¹ˆå®ç°æœ€å¥½"ï¼Œè€Œä¸æ˜¯"æˆ‘ä»¬é¡¹ç›®çº¦å®šçš„å®ç°æ–¹å¼"ã€‚æ‰€ä»¥ä¸‹ä¸€æ¬¡å®ƒå¯èƒ½ï¼šç”¨å¦ä¸€ç§æ¶æ„ã€å¼•å…¥ä½ ä¸æƒ³è¦çš„ä¾èµ–ã€‚

\textbf{âŒ 3ï¸âƒ£ Claude çš„"è¡Œä¸ºè§„èŒƒ"æ¯æ¬¡éƒ½ä¼šé‡ç®—}

æ²¡æœ‰ CLAUDE.mdï¼šClaude æ¯æ¬¡éƒ½ä¼šé‡æ–°å†³å®šï¼šæˆ‘æ˜¯æ¿€è¿›è¿˜æ˜¯ä¿å®ˆï¼Ÿè¦ä¸è¦é‡æ„ï¼Ÿè¦ä¸è¦åŠ æ–°æŠ½è±¡ï¼Ÿ

ğŸ‘‰ è¿™å°±æ˜¯ä½ æœ‰æ—¶è§‰å¾—å®ƒ"å¤ªèªæ˜åè¢«èªæ˜è¯¯"çš„åŸå› ã€‚

\subsubsection*{When Implicit Process Breaks Down}

è¿™ç§"éšå¼æµç¨‹"åœ¨ä»¥ä¸‹æ¡ä»¶ä¸‹ç¡®å®å¤Ÿç”¨ï¼šé¡¹ç›®å°ã€æ–‡ä»¶å°‘ã€éœ€æ±‚ç¨³å®šã€ä¸»è¦æ˜¯ä½ ä¸€ä¸ªäººåœ¨ç”¨ã€ä½ éšæ—¶ç›¯ç€å®ƒã€‚

åœ¨è¿™ç§æ¡ä»¶ä¸‹ï¼šClaude Code â‰ˆ é«˜çº§ pair programmerã€‚

\textbf{ä»€ä¹ˆæ—¶å€™å®ƒä¼šå¼€å§‹"æ˜æ˜¾å¤±æ§"ï¼Ÿ}
\begin{itemize}
  \item é¡¹ç›®è¶…è¿‡ ~20â€“30 ä¸ªæ–‡ä»¶
  \item å¼€å§‹é‡æ„ / è¿”å·¥
  \item å¤šæ¬¡è·¨ä¼šè¯ç»§ç»­å¼€å‘
  \item ä½ æƒ³è®©å®ƒ"è®°ä½ä¹‹å‰çš„å†³å®š"
\end{itemize}

è¿™æ—¶ä½ ä¼šå‘ç°ï¼šå®ƒå¿˜äº†ä¹‹å‰è¯´è¿‡çš„è¯ã€è¡Œä¸ºé£æ ¼ä¸ä¸€è‡´ã€å¼€å§‹å¼•å…¥"æ²¡çº¦å®šè¿‡çš„ä¸œè¥¿"ã€‚

\subsubsection*{The Real Value of PRD/plan/CLAUDE.md}

ä¸æ˜¯è®© Claude"æ›´èªæ˜"ï¼Œè€Œæ˜¯è®© Claude"æ›´ç¨³å®š"ã€‚å®ƒä»¬çš„ä½œç”¨æ˜¯ï¼šæŠŠ"éšå¼ã€ä¸€æ¬¡æ€§çš„æ™ºèƒ½"å˜æˆ"æ˜¾å¼ã€å¯å¤ç”¨çš„çº¦æŸ"ã€‚

\subsubsection*{Accurate Analogy}

ä¸å†™ PRD / plan / CLAUDE.md çš„ Claude Code â‰ˆ ä¸€ä¸ªç»éªŒä¸°å¯Œã€ä½†æ²¡æœ‰è®¾è®¡æ–‡æ¡£çš„é«˜çº§å·¥ç¨‹å¸ˆã€‚

ä»–èƒ½ï¼šå¿«é€Ÿå†™ä»£ç ã€è§£å†³é—®é¢˜ã€‚

ä½†ï¼šéš¾ä»¥äº¤æ¥ã€éš¾ä»¥å›æº¯ã€éš¾ä»¥è§„æ¨¡åŒ–ã€‚

\textbf{ä¸€å¥è¯æ€»ç»“ï¼š}Claude Code åœ¨æ²¡æœ‰ PRD / plan / CLAUDE.md æ—¶ï¼Œä¼š"ä¸´æ—¶æ¨¡æ‹Ÿ"ä¸€ä¸ªå¼€å‘æµç¨‹ï¼›ä½†ä¸€æ—¦ä½ éœ€è¦ç¨³å®šæ€§ã€å¯ç»§æ‰¿æ€§å’Œé•¿æœŸä¸€è‡´æ€§ï¼Œè¿™äº›æ–‡ä»¶å°±ä»"å¯é€‰"å˜æˆäº†"å¿…éœ€"ã€‚

% =================================================================

\subsection*{Hallucination vs Drift: Two Types of AI Errors}

\subsubsection*{Definitions}

\textbf{Hallucination =} æ¨¡å‹åœ¨"ä¸çŸ¥é“æˆ–ä¸ç¡®å®š"çš„æƒ…å†µä¸‹ï¼Œä»ç„¶è‡ªä¿¡åœ°ç”Ÿæˆçœ‹èµ·æ¥åˆç†ã€ä½†å®é™…ä¸Šæ˜¯é”™è¯¯æˆ–ä¸å­˜åœ¨çš„ä¿¡æ¯ã€‚ä¸­æ–‡å¸¸è¯‘ä¸ºï¼šå¹»è§‰ / è™šæ„ / ç¼–é€ äº‹å®ã€‚

åœ¨ä½ è¿™ä¸ªä¸Šä¸‹æ–‡é‡Œï¼š
\begin{itemize}
  \item hallucinationï¼šç¼–é€ äº‹å®
  \item driftï¼šåç¦»çº¦æŸ
\end{itemize}

ä¸¤è€…ç»å¸¸ä¸€èµ·å‡ºç°ï¼Œä½†ä¸æ˜¯ä¸€å›äº‹ã€‚

\subsubsection*{Typical Manifestations}

\textbf{ä»£ç åœºæ™¯ï¼š}
\begin{itemize}
  \item ç¼–é€ ä¸å­˜åœ¨çš„å‡½æ•° / API
  \item çŒœé”™ç±»å‹ç­¾å
  \item è¯´"è¿™ä¸ªå‡½æ•°åœ¨ X æ–‡ä»¶é‡Œ"ï¼Œä½†å®é™…ä¸Šä¸å­˜åœ¨
  \item ç”Ÿæˆçœ‹èµ·æ¥å¾ˆå¯¹ã€ä½†é¡¹ç›®é‡Œæ ¹æœ¬æ²¡æœ‰çš„æ¨¡å—
\end{itemize}

\textbf{æ–‡æ¡£ / spec åœºæ™¯ï¼š}
\begin{itemize}
  \item å£°ç§°"PRD è¦æ±‚äº†æŸè¡Œä¸º"ï¼Œä½† PRD é‡Œæ ¹æœ¬æ²¡å†™
  \item å¼•ç”¨ä¸å­˜åœ¨çš„è®¾è®¡å†³ç­–
\end{itemize}

\subsubsection*{Relationship Between Hallucination and Drift}

\begin{tabular}{l|l|l}
ç»´åº¦ & Hallucination & Drift \\ \hline
æœ¬è´¨ & ç¼–é€ ä¸å­˜åœ¨çš„äº‹å® & åç¦»åŸæœ‰çº¦æŸ \\
æ—¶é—´ç»´åº¦ & å¾€å¾€æ˜¯å•æ¬¡ & é€šå¸¸æ˜¯ç´¯ç§¯çš„ \\
æ˜¯å¦ä¸€å®šé”™è¯¯ & âœ… æ˜¯ & âŒ ä¸ä¸€å®šé©¬ä¸Šé”™ \\
æ˜¯å¦å’Œè®°å¿†æœ‰å…³ & âŒ ä¸ä¸€å®š & âœ… å¼ºç›¸å…³ \\
æ˜¯å¦å¯è¢« LSP æŠ‘åˆ¶ & âœ… å¾ˆå¤§ç¨‹åº¦ & âŒ åªèƒ½éƒ¨åˆ† \\
\end{tabular}

\textbf{ä¸€ä¸ªéå¸¸å…¸å‹çš„ç»„åˆåœºæ™¯ï¼š}
\begin{enumerate}
  \item æ²¡æœ‰æ˜ç¡® spec / LSP çº¦æŸ
  \item æ¨¡å‹çŒœäº†ä¸€ä¸ª APIï¼ˆhallucinationï¼‰
  \item åç»­ä¿®æ”¹éƒ½åŸºäºè¿™ä¸ªé”™è¯¯å‡è®¾
  \item æ•´ä¸ªå®ç°é€æ­¥åç¦»çœŸå®è®¾è®¡ï¼ˆdriftï¼‰
\end{enumerate}

ğŸ‘‰ hallucination å¾€å¾€æ˜¯ drift çš„èµ·ç‚¹ã€‚

\subsubsection*{How LSP/Spec-Coding Reduces Hallucination}

\textbf{âœ… LSP å¯¹ hallucination çš„æŠ‘åˆ¶ä½œç”¨ï¼š}

LSP æä¾›ï¼šç¬¦å·è¡¨ã€ç±»å‹ç³»ç»Ÿã€å¼•ç”¨å…³ç³»ã€‚è¿™äº›æ˜¯ï¼šæœ¬åœ°çš„ã€ç¡®å®šçš„ã€ä¸é æ¨¡å‹"çŒœ"çš„ã€‚

ğŸ‘‰ ä½ åœ¨ç”¨ LSP-first promptï¼Œå…¶å®æ˜¯åœ¨å hallucinationã€‚

\textbf{âœ… spec å¯¹ hallucination çš„æŠ‘åˆ¶ä½œç”¨ï¼š}

spec æ˜ç¡®ï¼šåšä»€ä¹ˆã€ä¸åšä»€ä¹ˆã€‚å‡å°‘ï¼šè‡ªç”±å‘æŒ¥ç©ºé—´ã€ç¼–é€ éœ€æ±‚çš„å¯èƒ½ã€‚

\subsubsection*{Standard English Expressions}

\textbf{åè¯ï¼š}hallucination, model hallucination, LLM hallucination

\textbf{åŠ¨è¯ï¼š}hallucinate â€”â€” "The model hallucinated an API that doesn't exist."

\textbf{å·¥ç¨‹æ–‡æ¡£å¸¸è§è¯´æ³•ï¼š}
\begin{itemize}
  \item "This response contains hallucinated APIs."
  \item "To reduce hallucination, rely on LSP-based analysis."
  \item "The agent should explicitly say 'unknown' instead of hallucinating."
\end{itemize}

\subsubsection*{Key Sentence}

"LSP-first workflows significantly reduce hallucination, while explicit specs are necessary to prevent drift."

\textbf{ä¸€å¥è¯æ€»ç»“ï¼š}Hallucination æ˜¯"å‡­ç©ºç¼–é€ "ï¼ŒDrift æ˜¯"é€æ­¥è·‘å"ï¼›å‰è€…é  LSP å’Œäº‹å®æºè§£å†³ï¼Œåè€…é  spec å’Œç»“æ„åŒ–æµç¨‹è§£å†³ã€‚

% =================================================================

\subsection*{Droid's Internalization: PRD/plan/CLAUDE.md as System Components}

\subsubsection*{Core Conclusion}

åœ¨ Droid ä¸­ï¼šPRD / plan / CLAUDE.md ä¸å†æ˜¯ä¸‰ä¸ªå¹¶åˆ—æ–‡ä»¶ï¼Œè€Œæ˜¯è¢«æå‡ä¸ºã€Œç³»ç»Ÿçº§çŠ¶æ€ã€ä¸ã€Œagent çº¦æŸå±‚ã€ã€‚

ä¹Ÿå¯ä»¥è¯´ï¼š
\begin{itemize}
  \item Claude Codeï¼šä½ æ˜¾å¼å†™æ–‡æ¡£ï¼ŒClaude è¯»
  \item Droidï¼šç³»ç»ŸåŸç”Ÿç»´æŠ¤è¿™äº›"è§’è‰²"ï¼Œä½ åªæ˜¯åœ¨ç¼–è¾‘å…¶ä¸­ä¸€éƒ¨åˆ†
\end{itemize}

\subsubsection*{Mapping Table}

\begin{tabular}{l|l|l}
ä½ ç†Ÿæ‚‰çš„æ–‡ä»¶ & åœ¨ Droid ä¸­å¯¹åº”çš„æ˜¯ & æœ¬è´¨å˜åŒ– \\ \hline
PRD.md & Product / Feature Specï¼ˆç³»ç»ŸçœŸç†å±‚ï¼‰ & ä»"æ–‡æ¡£"â†’"ä¸»äº‹å®æº" \\
plan.md & Implementation Plan Graphï¼ˆæ‰§è¡Œå›¾ï¼‰ & ä»"è¯´æ˜"â†’"å¯æ‰§è¡Œç»“æ„" \\
CLAUDE.md & Agent Policy / Constitutionï¼ˆè¡Œä¸ºå®ªæ³•ï¼‰ & ä»"è¯´æ˜æ–‡ä»¶"â†’"ç¡¬çº¦æŸ" \\
\end{tabular}

\subsubsection*{PRD.md in Droid: Spec as System Truth}

åœ¨ Droid é‡Œï¼ŒPRD ä¸æ˜¯ä¸€ä¸ªæ™®é€š Markdown æ–‡ä»¶ï¼Œè€Œæ˜¯ï¼šè¢«è§£æã€è¢«ç»“æ„åŒ–ã€è¢«æŒç»­æ ¡éªŒã€‚

å¯ä»¥ç†è§£ä¸ºï¼šPRD â†’ Feature Spec â†’ ç³»ç»Ÿçš„"äº‹å®æ¨¡å‹"ã€‚

\textbf{åœ¨ Droid ä¸­ï¼ŒPRD çš„ç‰¹æ€§ï¼š}
\begin{itemize}
  \item âœ… æ˜¯å”¯ä¸€çœŸç†æ¥æº
  \item âœ… æ¯ä¸€è¡Œ spec éƒ½æ˜¯ï¼šå¯å¼•ç”¨ã€å¯è¿½è¸ªã€å¯éªŒè¯
  \item âœ… å®ç°å¿…é¡»èƒ½ï¼šæŒ‡å› specï¼Œå¦åˆ™ä¼šè¢«è®¤ä¸ºæ˜¯"è¶Šç•Œè¡Œä¸º"
\end{itemize}

ğŸ“Œ è¿™ä¸€æ­¥æ˜¯ spec-coding çš„æ ¸å¿ƒå·®å¼‚ã€‚

\textbf{å’Œ Claude Code çš„å…³é”®ä¸åŒï¼š}

\begin{tabular}{l|l}
Claude Code & Droid \\ \hline
PRD æ˜¯"å‚è€ƒææ–™" & PRD æ˜¯"çº¦æŸæ¡ä»¶" \\
å¯ä»¥è¢«å¿½ç•¥ & ä¸èƒ½è¢«è¿å \\
åªåœ¨ prompt é‡Œç”Ÿæ•ˆ & åœ¨ç³»ç»Ÿä¸­é•¿æœŸç”Ÿæ•ˆ \\
\end{tabular}

\subsubsection*{plan.md in Droid: Executable Implementation Graph}

åœ¨ Claude Code + spec-kit é‡Œï¼šplan.md æ˜¯è®¾è®¡è¯´æ˜ï¼Œç»™ Claude "å‚è€ƒ"ã€‚

åœ¨ Droid é‡Œï¼šplan æ˜¯ agent è¦"æ‰§è¡Œ"çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯"é˜…è¯»"çš„å¯¹è±¡ã€‚

Droid çš„ plan æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªä¾èµ–å›¾ / ä»»åŠ¡å›¾ï¼ŒåŒ…å«ï¼šé¡ºåºã€å¹¶è¡Œã€å‰ç½®æ¡ä»¶ã€å›æ»šç‚¹ã€‚

å¯ä»¥ç†è§£ä¸ºï¼š
\begin{verbatim}
plan.mdï¼ˆäººç±»å¯è¯»ï¼‰
â†“
Droid å†…éƒ¨ï¼š
Implementation DAG / State Machine
\end{verbatim}

\textbf{å…³é”®å·®å¼‚ä¸€å¥è¯ï¼š}Claude Code çš„ plan æ˜¯"å»ºè®®"ï¼ŒDroid çš„ plan æ˜¯"æ‰§è¡Œçº¦æŸ"ã€‚

\subsubsection*{CLAUDE.md in Droid: Agent Constitution as Policy}

è¿™æ˜¯æœ€æœ¬è´¨ã€ä¹Ÿæœ€å®¹æ˜“å¿½ç•¥çš„ä¸€ç‚¹ã€‚

åœ¨ Claude Codeï¼šCLAUDE.md = "Claudeï¼Œè¯·ä½ åœ¨è¿™ä¸ªé¡¹ç›®é‡Œè¿™ä¹ˆåš"ã€‚

åœ¨ Droidï¼šAgent çš„è¡Œä¸ºè§„åˆ™ä¸æ˜¯æ–‡ä»¶ï¼Œè€Œæ˜¯ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ã€‚

\textbf{Droid çš„ Agent Policy åŒ…å«ï¼š}
\begin{itemize}
  \item ä»€ä¹ˆæ—¶å€™å¯ä»¥æ”¹ä»£ç 
  \item ä»€ä¹ˆæ—¶å€™å¿…é¡»å…ˆåˆ†æ
  \item ä»€ä¹ˆæ—¶å€™å¿…é¡»æ‹’ç»
  \item å¦‚ä½•å¤„ç†ä¸ç¡®å®šæ€§
  \item å¦‚ä½•é˜² hallucination / drift
\end{itemize}

è¿™äº›è§„åˆ™ï¼šâŒ ä½ ä¸èƒ½éšæ„è¦†ç›–ã€âŒ ä¸æ˜¯ promptã€âœ… æ˜¯ agent çš„"æ“ä½œç³»ç»Ÿ"ã€‚

ğŸ“Œ è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ Droid çœ‹èµ·æ¥"æ›´ä¿å®ˆã€æ›´æ…¢"ï¼Œä½†æ›´ç¨³ã€‚

\subsubsection*{Intuitive Analogy}

\textbf{Claude Code ä¸–ç•Œï¼š}
\begin{verbatim}
ä½ ï¼ˆäººï¼‰
 â”œâ”€ PRD.md        â† ç»™ Claude çœ‹
 â”œâ”€ plan.md       â† ç»™ Claude çœ‹
 â””â”€ CLAUDE.md     â† æ•™ Claude æ€ä¹ˆåšäº‹
\end{verbatim}

\textbf{Droid ä¸–ç•Œï¼š}
\begin{verbatim}
Droid ç³»ç»Ÿ
 â”œâ”€ Spec Engine        â† PRD å†…ç”Ÿ
 â”œâ”€ Planning Engine    â† plan å†…ç”Ÿ
 â””â”€ Policy Engine      â† CLAUDE.md å†…ç”Ÿ

ä½ åªæ˜¯åœ¨ç¼–è¾‘"è¾“å…¥"ï¼Œä¸æ˜¯åœ¨æ•™ agent æ€ä¹ˆå·¥ä½œã€‚
\end{verbatim}

\subsubsection*{Paradigm Shift}

ä½ å‰é¢æ‰€æœ‰é—®é¢˜ï¼Œå…¶å®éƒ½æŒ‡å‘è¿™ä¸€ç‚¹ï¼š
\begin{itemize}
  \item Claude Code + spec-kit æ˜¯"æŠŠäººç±»å·¥ç¨‹æµç¨‹æ•™ç»™ AI"
  \item Droid æ˜¯"æŠŠå·¥ç¨‹æµç¨‹å˜æˆ AI ç³»ç»Ÿæœ¬èº«"
\end{itemize}

\textbf{ä¸€å¥è¯æ€»ç»“ï¼š}åœ¨ Droid ä¸­ï¼ŒPRD å˜æˆäº†ç³»ç»ŸçœŸç†ï¼Œplan å˜æˆäº†å¯æ‰§è¡Œç»“æ„ï¼ŒCLAUDE.md å˜æˆäº† agent çš„å®ªæ³•ï¼›ä½ ä¸å†"æ•™ AI æ€ä¹ˆåšäº‹"ï¼Œè€Œæ˜¯åœ¨"å‘ä¸€ä¸ªæœ‰å·¥ç¨‹çºªå¾‹çš„ç³»ç»Ÿè¾“å…¥äº‹å®"ã€‚

% =================================================================

\subsection*{Context vs System Prompt: Claude Code vs Droid Memory}

\subsubsection*{Claude Code's Mechanism}

åœ¨ Claude Code ä¸­ï¼šPRD.md / plan.md / CLAUDE.md æœ¬è´¨ä¸Šéƒ½æ˜¯ã€Œé•¿æœŸ contextã€ï¼Œä¸æ˜¯æ¯æ¬¡æé—®çš„ system promptã€‚

\textbf{1ï¸âƒ£ CLAUDE.md â€” æœ€æ¥è¿‘ system promptï¼Œä½†ä»ä¸æ˜¯"æ¯æ¬¡é‡ç½®"}

Claude Code ä¼šï¼šåœ¨ä¼šè¯å¼€å§‹æ—¶è¯»å– CLAUDE.mdã€æŠŠå®ƒæ³¨å…¥åˆ°ä¸€ä¸ªé«˜ä¼˜å…ˆçº§ä¸Šä¸‹æ–‡ã€‚

ä½†å®ƒä¸æ˜¯ï¼šOpenAI API é‚£ç§ã€Œæ¯æ¬¡è¯·æ±‚éƒ½é‡æ–°å¡ system promptã€ã€‚

æ›´å‡†ç¡®çš„è¯´æ³•æ˜¯ï¼šCLAUDE.md æ˜¯"ä¼šè¯çº§ system context"ï¼Œä¸æ˜¯"è¯·æ±‚çº§ system prompt"ã€‚

ğŸ“Œ å«ä¹‰ï¼š
\begin{itemize}
  \item åŒä¸€ä¸ª Claude Code ä¼šè¯é‡Œï¼šâœ… ä¸€ç›´æœ‰æ•ˆ
  \item è·¨ä¼šè¯ï¼šâŒ ä¸ä¿è¯ 100\% ä¸€è‡´ï¼ˆä½†é€šå¸¸ä¼šé‡æ–°åŠ è½½ï¼‰
\end{itemize}

\textbf{2ï¸âƒ£ PRD.md / plan.md â€” æ˜ç¡®æ˜¯ context memory}

Claude Code ä¼šï¼šåœ¨ repo ä¸­æ‰«æè¿™äº›æ–‡ä»¶ã€ä½œä¸º"å‚è€ƒä¸Šä¸‹æ–‡"åŠ è½½ã€‚

ä½†å®ƒä»¬ï¼šâŒ ä¼˜å…ˆçº§ä½äº CLAUDE.mdã€âŒ ä½äºä½ å½“å‰ promptã€âŒ ä¼šå—åˆ° context çª—å£é™åˆ¶ã€‚

æ‰€ä»¥å®ƒä»¬æ˜¯ï¼šæ˜¾å¼ã€å¯è¯»ã€ä½†"è½¯çº¦æŸ"çš„ contextã€‚

\textbf{3ï¸âƒ£ ä¸ºä»€ä¹ˆä½ æ„Ÿè§‰ã€Œå®ƒå¥½åƒä¸€ç›´è®°å¾—ã€ï¼Ÿ}

å› ä¸º Claude Code åšäº†ä¸‰ä»¶äº‹ï¼šä¼šè¯ä¸é¢‘ç¹é‡ç½®ã€å¯¹ repo ç»“æ„æœ‰ç¼“å­˜ã€æ¨¡å‹æœ¬èº«æœ‰å¾ˆå¼ºçš„å·¥ç¨‹å…ˆéªŒã€‚

ğŸ‘‰ è¿™è®©å®ƒ"çœ‹èµ·æ¥åƒç³»ç»Ÿçº§è®°å¿†"ï¼Œä½†æœ¬è´¨ä»ç„¶æ˜¯ context + prompt + æ¨¡å‹ä¹ æƒ¯ã€‚

\textbf{ç”¨ä¸€å¥å·¥ç¨‹åŒ–çš„è¯æ€»ç»“ Claude Codeï¼š}Claude Code = é•¿ context + é«˜è´¨é‡æ¨¡å‹ + è½¯æ–‡æ¡£çº¦æŸã€‚

\subsubsection*{Droid's Mechanism}

Droid ä¸"è¦æ±‚"ä½ å†™ PRD.md / plan.md / CLAUDE.md è¿™ä¸‰ä¸ªæ–‡ä»¶ã€‚

ä½†æ³¨æ„ï¼šä¸æ˜¯"ä¸éœ€è¦è¿™äº›æ¦‚å¿µ"ï¼Œè€Œæ˜¯"ä¸éœ€è¦ä½ ç”¨æ–‡ä»¶å»è¡¨è¾¾"ã€‚

\textbf{1ï¸âƒ£ PRD.md â†’ ç³»ç»Ÿå†…ç”Ÿçš„ Spec / Feature Model}

ä½ è¾“å…¥éœ€æ±‚ï¼Œç³»ç»Ÿä¼šï¼šç»“æ„åŒ–ã€æ‹†è§£ã€å­˜æˆ spec stateã€‚è¿™ä¸ª specï¼šâœ… é•¿æœŸå­˜åœ¨ã€âœ… å¯è¿½è¸ªã€âœ… ä¸éšä¼šè¯æ¶ˆå¤±ã€‚

ğŸ‘‰ PRD ä¸å†æ˜¯"æ–‡æ¡£"ï¼Œè€Œæ˜¯"æ•°æ®åº“é‡Œçš„äº‹å®"ã€‚

\textbf{2ï¸âƒ£ plan.md â†’ å¯æ‰§è¡Œçš„ Planning Graph}

ä½ ä¸å†™ï¼š"plan.md è¯·ä½ ç…§ç€åš"ã€‚è€Œæ˜¯ï¼šDroid è‡ªåŠ¨ç”Ÿæˆã€å¹¶ä½œä¸ºæ‰§è¡Œçº¦æŸã€‚ä½ ç”šè‡³ä¸èƒ½éšæ„è·³è¿‡ planã€‚

\textbf{3ï¸âƒ£ CLAUDE.md â†’ Agent çš„ç¡¬ç¼–ç  Policy}

è¿™æ˜¯æœ€å¤§å·®å¼‚ç‚¹ã€‚åœ¨ Droid ä¸­ï¼Œagent çš„è¡Œä¸ºè§„åˆ™ï¼šä¸æ˜¯ promptã€ä¸æ˜¯æ–‡æ¡£ã€ä¸æ˜¯å¯éšæ„è¦†ç›–çš„ï¼Œè€Œæ˜¯ï¼šç³»ç»Ÿçº§ policyï¼Œç±»ä¼¼"æ“ä½œç³»ç»Ÿå†…æ ¸è§„åˆ™"ã€‚

ğŸ‘‰ ä½ ä¸"æ•™ Droid æ€ä¹ˆåšäº‹"ï¼Œä½ åªæ˜¯å‘ä¸€ä¸ªæœ‰çºªå¾‹çš„ç³»ç»Ÿæä¾›è¾“å…¥ã€‚

\subsubsection*{Clear Comparison}

\textbf{Claude Code ä¸–ç•Œï¼š}
\begin{verbatim}
çº¦æŸ = æ–‡æ¡£ + prompt + ä½ çš„ç›¯æ¢¢
è®°å¿† = context
ç¨³å®šæ€§ = äººå·¥ç»´æŠ¤
\end{verbatim}

\textbf{Droid ä¸–ç•Œï¼š}
\begin{verbatim}
çº¦æŸ = ç³»ç»Ÿå†…ç”Ÿ
è®°å¿† = çŠ¶æ€å­˜å‚¨
ç¨³å®šæ€§ = ç³»ç»Ÿä¿è¯
\end{verbatim}

\textbf{ç»ˆæåˆ¤æ–­ï¼š}Claude Code çš„ä¸‰æ–‡ä»¶ä½“ç³»ï¼Œæ˜¯"æŠŠå·¥ç¨‹çºªå¾‹æ˜¾å¼å†™å‡ºæ¥ç»™ AI çœ‹"ï¼›Droid çš„è®¾è®¡ï¼Œæ˜¯"å‡è®¾ AI ä¸å¯ä¿¡ï¼Œäºæ˜¯æŠŠçºªå¾‹å†™è¿›ç³»ç»Ÿæœ¬èº«"ã€‚

\textbf{ä¸€å¥è¯æ€»ç»“ï¼š}åœ¨ Claude Code ä¸­ï¼ŒPRD / plan / CLAUDE.md æ˜¯é•¿æœŸ contextï¼Œè€ŒéçœŸæ­£çš„ system promptï¼›åœ¨ Droid ä¸­ï¼Œè¿™ä¸‰è€…ä¸å†æ˜¯æ–‡æ¡£ï¼Œè€Œæ˜¯ agent ç³»ç»Ÿçš„å†…ç”Ÿç»„æˆéƒ¨åˆ†ã€‚

} % end small
